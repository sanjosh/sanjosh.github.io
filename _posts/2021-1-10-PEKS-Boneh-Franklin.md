---
layout: post
title: Public key encryption with keyword search
---

This is an attempt to convey the concept of encrypted search to non-cryptographers. Please excuse the lack of rigour for which I will compensate at the end of the article.

Assume you have a public key encryption system.

Let’s say you wanted a third-party to verify whether an encrypted text matches a search string, without 
1. decrypting the encrypted text or 
2. encrypting the search string

Let’s say encryption("*Nice*") = "*8Ev7*"

How can a third-party verify that "*8Ev7*" is actually "Nice" in encrypted form ?

What you need here is an auxiliary string called a **trapdoor** which the third-party can use to verify the equality

This problem is solved using a bilinear map, which enables two different ways of producing same encrypted text

A bilinear map is a function of two variables *f(x, y)* satifying this condition

![eqn1](/post_images/firsteqn.gif)

Lets say you have a public key encryption system where
1. public key = Pub
2. private key = Pvt

Let "*x*" be the text to be encrypted

The encrypted text will be generated by applying f(x, y) where "*y*" is the key combination

![eqn2](/post_images/secondeqn.gif)

Next, you have to generate an auxiliary string called the **trapdoor** in the form of original text raised to power of Pvt

![eqn3](/post_images/thirdeqn.gif)

along with a mangled public key

![eqn4](/post_images/fourtheqn.gif)

Now by the property of a bilinear map, the multiplication and division by PVT cancels out giving

![eqn5](/post_images/fiftheqn.gif)

So you have two ways of producing the same encrypted text !!

![eqn6](/post_images/sixtheqn.gif)

If you give this string "Vgzv" along with the modified public key (y^PVT) to the third-party, they can verify the equality

This is intuitively the first cryptographic construction produced by Boneh and Franklin in their paper

I have played fast and loose here to provide intuition.

![pic1](/post_images/pic1.jpg)

and

![pic2](/post_images/pic2.jpg)

and

![pic3](/post_images/pic3.jpg)

The trapdoor construction is more complex and cryptographically secure, in order to prevent the third-party from guessing the original text.

## Full scheme

![pic4](/post_images/full_scheme.jpg)

Alfred Menezies

Bethencourt
original paper

How to produce bilinear maps ?  Use Weil and Tate pairings over elliptic curves
